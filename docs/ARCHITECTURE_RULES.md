# ุงูููุงุนุฏ ุงููุนูุงุฑูุฉ โ Architecture Rules

> ๐ `docs/` ยท [โ ุฎุฑูุทุฉ ุงูุชูุซูู](documentation-map.md)
>
> โ๏ธ ูุฐุง ุงูููู ูู **ุงููุฑุฌุน ุงูุญุงูู** ููุฑุงุฌุนุงุช PR. ุฃู ููุฏ ูุฎุงูู ูุฐู ุงูููุงุนุฏ ููุฑูุถ.

## 1. ุงุชุฌุงู ุงูุงุนุชูุงุฏุงุช (Dependency Direction)

```
Presentation  โ Application โ Domain
Infrastructure โ Application โ Domain
```

| ุงููุงุนุฏุฉ | ุงูุชูุตูู |
| --- | --- |
| **R-DEP-01** | `Domain` ูุง ูุนุชูุฏ ุนูู ุฃู ุทุจูุฉ ุฃุฎุฑู โ ูู ุงูุทุจูุฉ ุงูุฃุนูู |
| **R-DEP-02** | `Application` ูุนุชูุฏ ุนูู `Domain` ููุท |
| **R-DEP-03** | `Infrastructure` ูุนุชูุฏ ุนูู `Application` ู `Domain` ููุท |
| **R-DEP-04** | `Presentation.WinForms` ูุนุชูุฏ ุนูู `Application` ููุท โ ูุง ูุตู ููุจููุฉ ุงูุชุญุชูุฉ ูุจุงุดุฑุฉ |
| **R-DEP-05** | `Bootstrapper` ูู ุงููุญูุฏ ุงูุฐู ูุฌูุน ูู ุงูุทุจูุงุช (Composition Root) |

> **ุงูุชุญูู ุงูุขูู:** `tests/ERP.ArchitectureGuard/ArchitectureDependencyTests.cs`

## 2. ุทุจูุฉ ุงููุทุงู โ Domain Layer (`ERP.Domain`)

| ุงููุงุนุฏุฉ | ุงูุชูุตูู |
| --- | --- |
| **R-DOM-01** | ุงูููุงุนุฏ ุงูุชุฌุงุฑูุฉ (Business Rules) ุชูุฌุฏ **ููุท** ูู Domain |
| **R-DOM-02** | ูู Aggregate Root ูุฑุซ ูู `Entity` ุฃู ูุทุจูู ูููุฉ ูุฑูุฏุฉ |
| **R-DOM-03** | ุงูุชุนุฏูู ูุชู ููุท ุนุจุฑ methods ุนูู ุงูู Aggregate Root โ ูุง ูุตูู ูุจุงุดุฑ ููููุงูุงุช ุงูุฏุงุฎููุฉ |
| **R-DOM-04** | ุงูู Invariants ุชููุฑุถ ุฏุงุฎู ุงูู Aggregate Root (constructor ุฃู methods) |
| **R-DOM-05** | ุนูุฏ ุงูุชูุงู invariant ููุฑูู Exception ูุงุถุญ ููุญุฏุฏ |
| **R-DOM-06** | Domain Events ุชูุตุงุบ ุจุตูุบุฉ ุงููุงุถู (ูุซู `JournalPosted`ุ `AccountRegistered`) |
| **R-DOM-07** | Domain Events ูุง ุชุญุชูู ููุทู ุฃุนูุงู โ ุจูุงูุงุช ููุท |
| **R-DOM-08** | Domain Events ุชูุตุฏุฑ ูู ุฏุงุฎู ุงูู Aggregate Root ููุท |
| **R-DOM-09** | ูุง ุฃุทุฑ ุนููุ ูุง ุจููุฉ ุชุญุชูุฉุ ูุง ูุงุฌูุงุช ูุณุชุฎุฏูุ ูุง ุชุฎุฒูู ุจูุงูุงุช ูู Domain |
| **R-DOM-10** | ูุง ููุทู ุญุงูุงุช ุงุณุชุฎุฏุงู ุฃู ุชูุณูู ุนูููุงุช ูู Domain |

## 3. ุทุจูุฉ ุงูุชุทุจูู โ Application Layer (`ERP.Application`)

| ุงููุงุนุฏุฉ | ุงูุชูุตูู |
| --- | --- |
| **R-APP-01** | CQRS ุฎููู: **Commands ุชูุบููุฑ ุงูุญุงูุฉ**ุ **Queries ูุง ุชูุบููุฑ ุงูุญุงูุฉ** |
| **R-APP-02** | ูู Use Case ููุงุจู Command ุฃู Query ูุงุญุฏ |
| **R-APP-03** | Command = ูุงุฆู ุจูุงูุงุช (DTO) ูุตู ุงูุนูููุฉ ุงููุทููุจุฉ |
| **R-APP-04** | Command Handler ูุง ููุฑุฌุน ุจูุงูุงุช (ุฃู ูุฑุฌุน ID ููุท ุนูุฏ ุงูุถุฑูุฑุฉ) |
| **R-APP-05** | Query Handler ููุฑุฃ ูู Repository ูููุฑุฌุน DTO โ ูุง ููุบููุฑ ุญุงูุฉ ุฃู Aggregate |
| **R-APP-06** | Handler ูุณุชุฎุฏู `IUnitOfWork` ูุถูุงู ุญุฏูุฏ ุงููุนุงููุฉ |
| **R-APP-07** | Handler ููููุถ ููุทู ุงูุฃุนูุงู ููู Domain โ ูุง ููุงุนุฏ ุฃุนูุงู ูู Application |
| **R-APP-08** | Application ูุนุฑูู ูุงุฌูุงุช ุงูุจููุฉ ุงูุชุญุชูุฉ (Repositoriesุ `IUnitOfWork`) โ ูุง ููููุฐูุง |
| **R-APP-09** | ูุง ุชูููุฐุงุช ุชูููุฉ ุฃู ุชุนุงูู ูุจุงุดุฑ ูุน ุงูุจููุฉ ุงูุชุญุชูุฉ |

## 4. ุทุจูุฉ ุงูุจููุฉ ุงูุชุญุชูุฉ โ Infrastructure Layer (`ERP.Infrastructure`)

| ุงููุงุนุฏุฉ | ุงูุชูุตูู |
| --- | --- |
| **R-INF-01** | Repository ูุทุจูู ูุงุฌูุฉ ูุนุฑููุฉ ูู Application |
| **R-INF-02** | ูุง ููุทู ุฃุนูุงู ุฃู ููุงุนุฏ ูุทุงู ูู Infrastructure |
| **R-INF-03** | ูููู ุงุณุชุจุฏุงู ุงูุชูููุฐ (ูุซูุงู In-Memory โ EF Core) ุจุฏูู ุชุฃุซูุฑ ุนูู ุงูุทุจูุงุช ุงูุฃุฎุฑู |
| **R-INF-04** | ูู ุชูุงูู ุฎุงุฑุฌู ูุทุจูู ูุงุฌูุฉ ูุนุฑููุฉ ูู Application |
| **R-INF-05** | ููุณุฌููู ูู DI Container ุนุจุฑ `InfrastructureModule` |

## 5. ุทุจูุฉ ุงูุนุฑุถ โ Presentation Layer (`ERP.Presentation.WinForms`)

| ุงููุงุนุฏุฉ | ุงูุชูุตูู |
| --- | --- |
| **R-PRE-01** | ูุง ููุทู ุฃุนูุงูุ ูุง ููุงุนุฏ ูุทุงู ูู Presentation |
| **R-PRE-02** | ูุง ูุตูู ูุจุงุดุฑ ููุจููุฉ ุงูุชุญุชูุฉ โ ุชุชุนุงูู ูุน Application ููุท |
| **R-PRE-03** | ุงุชุจุงุน Supervising Controller / Passive View |
| **R-PRE-04** | ุงูู Controllers ุชูุณูู ุญุงูุงุช ุงูุงุณุชุฎุฏุงู ูุชุญุฏูุซ ุงูู Views |

## 6. ููุทุฉ ุงูุชุดุบูู โ Bootstrapper (`ERP.Bootstrapper`)

| ุงููุงุนุฏุฉ | ุงูุชูุตูู |
| --- | --- |
| **R-BST-01** | `Bootstrapper` ูู ุงูู Composition Root ุงููุญูุฏ |
| **R-BST-02** | ูุชู ุญูู ุฌููุน ุงูุงุนุชูุงุฏุงุช ุตุฑุงุญุฉู โ ูุง Service Locators |
| **R-BST-03** | ูุง ููุทู ุฃุนูุงู โ ุชููุฆุฉ ูุชุณุฌูู ูุชุดุบูู ููุท |

## 7. ุงูุงุฎุชุจุงุฑุงุช โ Testing

| ุงููุงุนุฏุฉ | ุงูุชูุตูู |
| --- | --- |
| **R-TST-01** | ูู invariant ูู Domain ูุฌุจ ุฃู ูููู ูู ุงุฎุชุจุงุฑ ูู `tests/ERP.Domain.Tests` |
| **R-TST-02** | ูู Use Case handler ูุฌุจ ุฃู ูููู ูู ุงุฎุชุจุงุฑ ูู `tests/ERP.Application.Tests` |
| **R-TST-03** | ุญุฏูุฏ ุงูุงุนุชูุงุฏุงุช ุจูู ุงูุทุจูุงุช ุชูุญุฑุณ ุจู `tests/ERP.ArchitectureGuard` |

## 8. ุงูุชูุซูู โ Documentation

| ุงููุงุนุฏุฉ | ุงูุชูุตูู |
| --- | --- |
| **R-DOC-01** | ูู ููู `.md` ูู `docs/` ูุจุฏุฃ ุจุนููุงู `# Title` |
| **R-DOC-02** | `README.md` ููููููุฏ ุชููุงุฆูุงู โ ูุง ููุนุฏููู ูุฏููุงู |
| **R-DOC-03** | ุงูุชุบููุฑุงุช ูู ุงูุชูุซูู ุชุชู ุนุจุฑ ูููุงุช `docs/` ุซู ุชุดุบูู `scripts/generate-readme.sh` |

## ูุฑุฌุน ุณุฑูุน โ Quick Reference

```
โ ุงูููุงุนุฏ ุงูุชุฌุงุฑูุฉ โ Domain ููุท
โ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู โ Application (Command/Query + Handler)
โ ุงูุชูููุฐุงุช ุงูุชูููุฉ โ Infrastructure
โ ุงููุงุฌูุฉ โ Presentation (ูุง ููุทู ุฃุนูุงู)
โ ุงูุชุฌููุน โ Bootstrapper (Composition Root)
โ ุงูุงุนุชูุงุฏุงุช โ ูุญู ุงูุฏุงุฎู ููุท
โ ุงูุงุฎุชุจุงุฑุงุช โ ูู invariant ููู use-case
โ Service Locators
โ ููุทู ุฃุนูุงู ุฎุงุฑุฌ Domain
โ ูุตูู Presentation ููุจููุฉ ุงูุชุญุชูุฉ
```

_Last Updated: 2026-02-10_
